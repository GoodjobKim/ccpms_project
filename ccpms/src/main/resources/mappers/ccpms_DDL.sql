CREATE DATABASE CCPMS;
USE CCPMS;

CREATE TABLE `ADMIN`(
	ADMIN_ID	VARCHAR(20) PRIMARY KEY,
    PASSWD		VARCHAR(100),
    JOIN_DT		TIMESTAMP
);

INSERT INTO `ADMIN` VALUES('ccpmsadmin', 'Sh@d0w', NOW());

CREATE TABLE MEMBER(
	MEMBER_ID	VARCHAR(20) PRIMARY KEY,
    PASSWD		VARCHAR(200),
	MEMBER_NM	VARCHAR(10),
	SEX			CHAR(1),
    DATE_BIRTH	CHAR(10),
    HP			VARCHAR(50),
    SMSSTS_YN	CHAR(1),
    EMAIL		VARCHAR(50),
    EMAILSTS_YN	CHAR(1),
    ZIPCODE		VARCHAR(10),
    ROAD_ADDRESS	VARCHAR(500),
    JIBUN_ADDRESS	VARCHAR(500),
    NAMUJI_ADDRESS	VARCHAR(500),
    POINT		INT,
    JOIN_DT		TIMESTAMP
);

CREATE TABLE GOODS(
	GOODS_CD		INT PRIMARY KEY,
    GOODS_NM		VARCHAR(100),
    ACTOR			VARCHAR(200),
    LOCATION		VARCHAR(100),
    SORT			VARCHAR(50),
    PART			VARCHAR(100),
    PUBLISHED_DT	TIMESTAMP,
    PUBLISHED_TIME	VARCHAR(200),
    SHOWTIME		VARCHAR(200),
    GRADE			VARCHAR(50),
    PRICE			INT,
    START_DT		TIMESTAMP,
    END_DT			TIMESTAMP,
    POINT			INT,
    SHOW_INTRO		VARCHAR(3000),
    ACTOR_INFO		VARCHAR(3000),
    CONTENTS_ORDER	VARCHAR(3000),
    GOODS_FILE_NAME	VARCHAR(300),
    ENROLL_DT		TIMESTAMP,
    DISCOUNT_RATE	INT,
    STOCK			INT,
    DELIVERY_INFO	VARCHAR(100),
    DELIVARY_PRICE	INT,
    GENRE			VARCHAR(50)
);
CREATE TABLE `ORDER` (
	ORDER_CD			BIGINT AUTO_INCREMENT PRIMARY KEY ,
    MEMBER_ID			VARCHAR(20),
    GOODS_CD			INT,
    ORDER_GOODS_QTY		INT,
    PAYMENT_AMT			INT,
    ORDERER_NM			VARCHAR(20),
    ORDERER_HP			VARCHAR(100),
    RECEIVER_NM			VARCHAR(20),
    RECEIVER_HP			VARCHAR(100),
    ZIPCODE				VARCHAR(10),
    ROAD_ADDRESS		VARCHAR(200),
    JIBUN_ADDRESS		VARCHAR(200),
    NAMUJI_ADDRESS		VARCHAR(200),
    DELIVERY_METHOD		VARCHAR(40),
    DELIVERY_MESSAGE	VARCHAR(300),
    DELIVERY_STATUS		VARCHAR(30),
    PAY_METHOD			VARCHAR(100),
    PAY_ORDERER_HP		VARCHAR(50),
    CARD_COMPANY_NM		VARCHAR(50),
    CARD_PAY_MONTH		VARCHAR(20),
    PAY_ORDER_TIME		TIMESTAMP
);

CREATE TABLE CART(
	CART_CD			BIGINT AUTO_INCREMENT PRIMARY KEY,
    MEMBER_ID		VARCHAR(20),
    GOODS_CD		INT,
    CART_GOODS_QTY	INT,
    ENROLL_DT		TIMESTAMP
);

CREATE TABLE CONTACT_BOARD(
	BOARD_ID		BIGINT AUTO_INCREMENT PRIMARY KEY,
    MEMBER_ID		VARCHAR(20),
    SUBJECT			VARCHAR(200),
    CONTENT			VARCHAR(2000),
    PASSWD			VARCHAR(200),
    READ_CNT		INT DEFAULT 0,
    ENROLL_DT		TIMESTAMP DEFAULT NOW()
);

CREATE TABLE CONTACT_REPLY(
	REPLY_ID		BIGINT AUTO_INCREMENT PRIMARY KEY,
    ADMIN_ID		VARCHAR(20),
    MEMBER_ID		VARCHAR(20),
    CONTENT			VARCHAR(2000),
    PASSWD			VARCHAR(200),
    ENROLL_DT		TIMESTAMP DEFAULT NOW(),
    BOARD_ID		BIGINT,
    FOREIGN KEY(BOARD_ID) REFERENCES CONTACT_BOARD(BOARD_ID)
	ON			DELETE CASCADE
);


/*AUTO_INCREMENT초기화 방법,CONTACT_BOARD테이블에서 BOARD_ID는 FOREIGN KEY라서 ALTER TABLE CONTACT_BOARD AUTO_INCREMENT=1; 만써줘야 할듯

ALTER TABLE GOODS AUTO_INCREMENT=1;
SET @COUNT=0;
UPDATE GOODS SET GOODS_CD = @COUNT:=@COUNT+1;

*/
